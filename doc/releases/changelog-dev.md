:orphan:

# Release 0.34.0-dev (development release)

<h3>New features since last release</h3>

<h4>Decompose circuits into the Clifford+T gateset üß©</h4>

* `qml.transforms.decompositions.sk_decomposition` method implements the Solovay-Kitaev algorithm for
  approximately decomposing any single-qubit operation to Clifford+T basis.
  [(#4801)](https://github.com/PennyLaneAI/pennylane/pull/4801)

<h4>Transforms (TODO: better title) ü§ñ</h4>

<h4>Use an iterative approach for quantum phase estimation üîÑ</h4>

* Iterative Quantum Phase Estimation is now available from `qml.iterative_qpe`.
  [(#4804)](https://github.com/PennyLaneAI/pennylane/pull/4804)

  The subroutine can be used similarly to mid-circuit measurements: 

  ```python
  
  import pennylane as qml
  
  dev = qml.device("default.qubit", shots = 5)

  @qml.qnode(dev)
  def circuit():

    # Initial state
    qml.PauliX(wires = [0])

    # Iterative QPE
    measurements = qml.iterative_qpe(qml.RZ(2., wires = [0]), ancilla = [1], iters = 3)

    return [qml.sample(op = meas) for meas in measurements]
  ```
  
  ```pycon
  >>> print(circuit())
  [array([0, 0, 0, 0, 0]), array([1, 0, 0, 0, 0]), array([0, 1, 1, 1, 1])]
  ```
  
  The i-th element in the list refers to the 5 samples generated by the i-th measurement of the algorithm.

<h4>Drawing and statistics for mid-circuit measurements üé®</h4>

* `qml.draw` now supports drawing mid-circuit measurements.
  [(#4775)](https://github.com/PennyLaneAI/pennylane/pull/4775)

<h4>Catalyst is seamlessly integrated with PennyLane ‚öóÔ∏è</h4>

<h3>Improvements üõ†</h3>

<h4>Community contributions ü•≥</h4>

* Approximate Quantum Fourier Transform (AQFT) is now available from `qml.AQFT`.
  [(#4715)](https://github.com/PennyLaneAI/pennylane/pull/4715)

* `qml.draw` and `qml.draw_mpl` now render operator ids.
  [(#4749)](https://github.com/PennyLaneAI/pennylane/pull/4749)

* The function ``qml.equal`` now supports ``ControlledSequence`` operators.
  [(#4829)](https://github.com/PennyLaneAI/pennylane/pull/4829)

* XZX decomposition is added to the list of supported single-qubit unitary decompositions.
  [(#4862)](https://github.com/PennyLaneAI/pennylane/pull/4862)

* Non-parametric-ops such as `Barrier`, `Snapshot` and `Wirecut` have been grouped together and moved to `pennylane/ops/meta.py`.
  Additionally, the relevant tests have been organized and placed in a new file, `tests/ops/test_meta.py` .
  [(#4789)](https://github.com/PennyLaneAI/pennylane/pull/4789)

<h4>Better support for batching</h4>

* `default.qubit` now can evolve already batched states with `ParametrizedEvolution`
  [(#4863)](https://github.com/PennyLaneAI/pennylane/pull/4863)

* `AmplitudeEmbedding` now also supports batching when used with Tensorflow.
  [(#4818)](https://github.com/PennyLaneAI/pennylane/pull/4818)

* `qml.draw` and `qml.draw_mpl` now support drawing mid-circuit measurements.
  [(#4775)](https://github.com/PennyLaneAI/pennylane/pull/4775)
  [(#4832)](https://github.com/PennyLaneAI/pennylane/pull/4832)

* `qml.ArbitraryUnitary` now supports batching.
  [(#4745)](https://github.com/PennyLaneAI/pennylane/pull/4745)

<h4>Performance improvements and benchmarking</h4>

* `default.qubit` no longer uses a dense matrix for `MultiControlledX` for more than 8 operation wires.
  [(#4673)](https://github.com/PennyLaneAI/pennylane/pull/4673)

* Autograd and torch can now use vjps provided by the device from the new device API. If a device provides
  a vector Jacobian product, this can be selected by providing `device_vjp=True` to
  `qml.execute`.
  [(#4557)](https://github.com/PennyLaneAI/pennylane/pull/4557)
  [(#4654)](https://github.com/PennyLaneAI/pennylane/pull/4654)

* Updates to some relevant Pytests to enable its use as a suite of benchmarks.
  [(#4703)](https://github.com/PennyLaneAI/pennylane/pull/4703)

* Added `__iadd__` method to PauliSentence, which enables inplace-addition using `+=`, we no longer need to perform a copy, leading to performance improvements.
  [(#4662)](https://github.com/PennyLaneAI/pennylane/pull/4662) 

* `default.qubit` now applies `GroverOperator` faster by not using its matrix representation but a
  custom rule for `apply_operation`. Also, the matrix representation of `GroverOperator` runs faster now.
  [(#4666)](https://github.com/PennyLaneAI/pennylane/pull/4666)

<h4>Other improvements</h4>

* Added `ops.functions.assert_valid` for checking if an `Operator` class is defined correctly.
  [(#4764)](https://github.com/PennyLaneAI/pennylane/pull/4764)

* Added `__eq__` method for TransformProgram and TransformContainers allowing the comparison of respective objects using `==` and `!=` operators.
  [(#4858)](https://github.com/PennyLaneAI/pennylane/pull/4858)

* `GlobalPhase` now decomposes to nothing, in case devices do not support global phases.
  [(#4855)](https://github.com/PennyLaneAI/pennylane/pull/4855)

* Custom operations can now provide their matrix directly through the `Operator.matrix()` method
  without needing to update the `has_matrix` property. `has_matrix` will now automatically be
  `True` if `Operator.matrix` is overridden, even if
  `Operator.compute_matrix` is not.
  [(#4844)](https://github.com/PennyLaneAI/pennylane/pull/4844)

* Simplified the logic for re-arranging states before returning.
  [(#4817)](https://github.com/PennyLaneAI/pennylane/pull/4817)

* When multiplying `SparseHamiltonian`s by a scalar value, the result stays as a 
  `SparseHamiltonian`.
  [(#4828)](https://github.com/PennyLaneAI/pennylane/pull/4828)

* `default.qubit` now calculates the expectation value of Hermitians in a differentiable manner.
  [(#4866)](https://github.com/PennyLaneAI/pennylane/pull/4866)

* The `rot` decomposition now has support for returning a global phase.
  [(#4869)](https://github.com/PennyLaneAI/pennylane/pull/4869)

<h3>Breaking changes üíî</h3>

* The decomposition of `GroverOperator` now has an additional global phase operation.
  [(#4666)](https://github.com/PennyLaneAI/pennylane/pull/4666)

* Moved `qml.cond` and the `Conditional` operation from the `transforms` folder to the `ops/op_math` folder.
  `qml.transforms.Conditional` will now be available as `qml.ops.Conditional`.
  [(#4860)](https://github.com/PennyLaneAI/pennylane/pull/4860)

* The `prep` keyword argument has been removed from `QuantumScript` and `QuantumTape`.
  `StatePrepBase` operations should be placed at the beginning of the `ops` list instead.
  [(#4756)](https://github.com/PennyLaneAI/pennylane/pull/4756)

* `qml.gradients.pulse_generator` has become `qml.gradients.pulse_odegen` to adhere to paper naming conventions.
  [(#4769)](https://github.com/PennyLaneAI/pennylane/pull/4769)

* Specifying `control_values` passed to `qml.ctrl` as a string is no longer supported.
  [(#4816)](https://github.com/PennyLaneAI/pennylane/pull/4816)

* The `rot` decomposition will now normalize its rotation angles to the range `[0, 4pi]` for consistency
  [(#4869)](https://github.com/PennyLaneAI/pennylane/pull/4869)

* `QuantumScript.graph` is now built using `tape.measurements` instead of `tape.observables`
  because it depended on the now-deprecated `Observable.return_type` property.
  [(#4762)](https://github.com/PennyLaneAI/pennylane/pull/4762)

<h3>Deprecations üëã</h3>

* `single_tape_transform`, `batch_transform`, `qfunc_transform`, and `op_transform` are deprecated.
  Instead switch to using the new `qml.transform` function.
  [(#4774)](https://github.com/PennyLaneAI/pennylane/pull/4774)

* `Observable.return_type` is deprecated. Instead, you should inspect the type
  of the surrounding measurement process.
  [(#4762)](https://github.com/PennyLaneAI/pennylane/pull/4762)
  [(#4798)](https://github.com/PennyLaneAI/pennylane/pull/4798)

* All deprecations now raise a `qml.PennyLaneDeprecationWarning` instead of a `UserWarning`.
  [(#4814)](https://github.com/PennyLaneAI/pennylane/pull/4814)

* `QuantumScript.is_sampled` and `QuantumScript.all_sampled` are deprecated.
  Users should now validate these properties manually.
  [(#4773)](https://github.com/PennyLaneAI/pennylane/pull/4773)

<h3>Documentation üìù</h3>

* Documentation page for `qml.measurements` now links top-level accessible functions (e.g. `qml.expval`) 
  to their top-level pages (rather than their module-level pages, eg. `qml.measurements.expval`).
  [(#4750)](https://github.com/PennyLaneAI/pennylane/pull/4750)

<h3>Bug fixes üêõ</h3>

* Fix a bug where trainable parameters in the post-processing of finite diff were incorrect for Jax when applying
  the transform directly on a ``QNode``.
  [(#4879)](https://github.com/PennyLaneAI/pennylane/pull/4879)

* `qml.grad` and `qml.jacobian` now explicitly raise errors if trainable parameters are integers.
  [(#4836)](https://github.com/PennyLaneAI/pennylane/pull/4836)

* JAX JIT now works with shot vectors.
  [(#4772)](https://github.com/PennyLaneAI/pennylane/pull/4772/)

* JAX can now differentiate a batch of circuits where one tape does not have trainable parameters.
  [(#4837)](https://github.com/PennyLaneAI/pennylane/pull/4837)

* The decomposition of `GroverOperator` now has the same global phase as its matrix.
  [(#4666)](https://github.com/PennyLaneAI/pennylane/pull/4666)

* The `tape.to_openqasm` method no longer mistakenly includes interface information in the parameter 
  string when converting tapes using non-numpy interfaces.
  [(#4849)](https://github.com/PennyLaneAI/pennylane/pull/4849)

* `qml.defer_measurements` now correctly transforms circuits when terminal measurements include wires
  used in mid-circuit measurements.
  [(#4787)](https://github.com/PennyLaneAI/pennylane/pull/4787)

* Fixes a bug where the adjoint method differentiation would fail if
  an operation with `grad_method=None` that has a parameter is present.
  [(#4820)](https://github.com/PennyLaneAI/pennylane/pull/4820)
  
* `MottonenStatePreparation` now raises an error if decomposing a broadcasted state vector.
  [(#4767)](https://github.com/PennyLaneAI/pennylane/pull/4767)

* `BasisStatePreparation` now raises an error if decomposing a broadcasted state vector.
  [(#4767)](https://github.com/PennyLaneAI/pennylane/pull/4767)

* Gradient transforms now work with overridden shot vectors and default qubit.
  [(#4795)](https://github.com/PennyLaneAI/pennylane/pull/4795)

* Any `ScalarSymbolicOp`, like `Evolution`, now states that it has a matrix if the target
  is a `Hamiltonian`.
  [(#4768)](https://github.com/PennyLaneAI/pennylane/pull/4768)

* In `default.qubit`, initial states are now initialized with the simulator's wire order, not the circuit's
  wire order.
  [(#4781)](https://github.com/PennyLaneAI/pennylane/pull/4781)

* `transpile` can now handle measurements that are broadcasted onto all wires.
  [(#4793)](https://github.com/PennyLaneAI/pennylane/pull/4793)

* Parametrized circuits whose operators do not act on all wires return pennylane tensors as
  expected, instead of numpy arrays.
  [(#4811)](https://github.com/PennyLaneAI/pennylane/pull/4811)
  [(#4817)](https://github.com/PennyLaneAI/pennylane/pull/4817)

* `merge_amplitude_embeddings` no longer depends on queuing, allowing it to work as expected
  with QNodes.
  [(#4831)](https://github.com/PennyLaneAI/pennylane/pull/4831)

* `qml.pow(op)` and `qml.QubitUnitary.pow()` now also work with Tensorflow data raised to an
  integer power.
  [(#4827)](https://github.com/PennyLaneAI/pennylane/pull/4827)

<h3>Contributors ‚úçÔ∏è</h3>

This release contains contributions from (in alphabetical order):

Guillermo Alonso,
Thomas Bromley,
Astral Cai,
Isaac De Vlugt,
Amintor Dusko,
Lillian Frederiksen,
Emiliano Godinez Ramirez,
Ankit Khandelwal,
Christina Lee,
Romain Moyard,
Anurav Modak,
Mudit Pandey,
Matthew Silverman,
David Wierichs,
Justin Woodring,
